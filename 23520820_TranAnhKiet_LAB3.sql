    --BAI 1
    CREATE DATABASE QLBH
    USE QLBH
    SET DATEFORMAT DMY

--Delete table
    DELETE NHANVIEN
    DELETE KHACHHANG
    DELETE SANPHAM
    DELETE HOADON
    DELETE CTHD


    CREATE TABLE KHACHHANG
    (
        MAKH CHAR(4),
        HOTEN VARCHAR(40),
        DCHI VARCHAR(50),
        SODT VARCHAR(20),
        NGSINH SMALLDATETIME,
        DOANHSO MONEY,
        NGDK SMALLDATETIME,
        PRIMARY KEY (MAKH)
    )

    CREATE TABLE NHANVIEN
    (
        MANV CHAR(4),
        HOTEN VARCHAR(40),
        SODT VARCHAR(20),
        NGVL SMALLDATETIME,
        PRIMARY KEY (MANV)
    )

    CREATE TABLE SANPHAM
    (
        MASP CHAR(4),
        TENSP VARCHAR(40),
        DVT VARCHAR(20),
        NUOCSX VARCHAR(40),
        GIA MONEY,
        PRIMARY KEY (MASP)
    )

    CREATE TABLE HOADON
    (
        SOHD INT,
        NGHD SMALLDATETIME,
        MAKH CHAR(4),
        MANV CHAR(4),
        TRIGIA MONEY,
        PRIMARY KEY (SOHD)
    )

    CREATE TABLE CTHD
    (
        SOHD INT,
        MASP CHAR(4),
        SL INT
    )

    --Cau 1
    -- Khoa ngoai cho bang HOADON
    ALTER TABLE HOADON ADD CONSTRAINT fk01_HD FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH)
    ALTER TABLE HOADON ADD CONSTRAINT fk02_HD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)

    -- Khoa ngoai cho bang CTHD
    ALTER TABLE CTHD ADD CONSTRAINT fk01_CTHD FOREIGN KEY(SOHD) REFERENCES HOADON(SOHD)
    ALTER TABLE CTHD ADD CONSTRAINT fk02_CTHD FOREIGN KEY(MASP) REFERENCES SANPHAM(MASP)

    --Cau 2
    ALTER TABLE SANPHAM ADD GHICHU VARCHAR(20)

    --Cau 3
    ALTER TABLE KHACHHANG ADD LOAIKH TINYINT
    --Cau 4
    ALTER TABLE SANPHAM ALTER COLUMN GHICHU VARCHAR(100)

    --Cau 5
    ALTER TABLE SANPHAM DROP COLUMN GHICHU

    --Cau 6
    ALTER TABLE KHACHHANG
    ALTER COLUMN LOAIKH VARCHAR(20);

    ALTER TABLE KHACHHANG
    ADD CONSTRAINT CK_LOAIKH CHECK (LOAIKH IN ('Vang lai', 'Thuong xuyen', 'VIP'))
    
    --Cau 7
    ALTER TABLE SANPHAM
    ADD CONSTRAINT CK_DVT CHECK (DVT IN ('cay', 'hop', 'cai', 'quyen', 'chuc'))

    --Cau 8
    ALTER TABLE SANPHAM
    ADD CONSTRAINT CK_GIA CHECK (GIA >= 500)

    --Cau 9
    ALTER TABLE CTHD
    ADD CONSTRAINT CK_SL CHECK (SL >= 1)

    --Cau 10
    ALTER TABLE KHACHHANG
    ADD CONSTRAINT CK_NGDK CHECK (NGDK > NGSINH)

    --Phan II
    --Cau 1: nhap du lieu cho CSDL QuanLyBanHang
    SET DATEFORMAT DMY 
    INSERT INTO NHANVIEN(MANV,HOTEN,SODT,NGVL) VALUES ('NV01', 'Nguyen Nhu Nhut', '0927345678', '13/4/2006')
    INSERT INTO NHANVIEN(MANV,HOTEN,SODT,NGVL) VALUES ('NV02','LE THI PHI YEN','0987567390','21/04/2006')
    INSERT INTO NHANVIEN(MANV,HOTEN,SODT,NGVL) VALUES ('NV03','NGUYEN VAN B','0997047382','27/04/2006')
    INSERT INTO NHANVIEN(MANV,HOTEN,SODT,NGVL) VALUES ('NV04','NGO THANH TUAN','0913758498','24/06/2006')
    INSERT INTO NHANVIEN(MANV,HOTEN,SODT,NGVL) VALUES ('NV05','NGUYEN THI TRUC THANH','0918590387','20/07/2006')
    
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH01','Nguyen Van A','731 Tran Hung Dao, Q5, TpHCM','08823451','22/10/1960',13060000,'22/07/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH02','Tran Ngoc Han','23/5 Nguyen Trai, Q5, TpHCM','0908256478','3/4/1974',280000,'30/07/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH03','Tran Ngoc Linh','45 Nguyen Canh Chan, Q1, TpHCM','0938776266','12/6/1980',3860000,'05/08/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH04','Tran Minh Long','50/34 Le Dai Hanh, Q10, TpHCM','0917325476','9/3/1965',250000,'02/10/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH05','Le Nhat Minh','34 Truong Dinh, Q3, TpHCM','08246108','10/3/1950',21000,'28/10/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH06','Le Hoai Thuong','227 Nguyen Van Cu, Q5, TpHCM','08631738','31/12/1981',915000,'24/11/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH07','Nguyen Van Tam','32/3 Tran Binh Trong, Q5, TpHCM','0916783565','6/4/1971',12500,'01/12/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH08','Phan Thi Thanh','45/2 An Duong Vuong, Q5, TpHCM','0938435756','10/1/1971',365000,'13/12/2006')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH09','Le Ha Vinh','873 Le Hong Phong, Q5, TpHCM','08654763','3/9/1979',70000,'14/01/2007')
    INSERT INTO KHACHHANG(MAKH,HOTEN,DCHI,SODT,NGSINH,DOANHSO,NGDK) VALUES ('KH10','Ha Duy Lap','34/34B Nguyen Trai, Q1, TpHCM','08768904','2/5/1983',67500,'16/01/2007')
    
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BC01','But chi','cay','Singapore',3000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BC02','But chi','cay','Singapore',5000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BC03','But chi','cay','Viet Nam',3500)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BC04','But chi','hop','Viet Nam',30000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BB01','But bi','cay','Viet Nam',5000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BB02','But bi','cay','Trung Quoc',7000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('BB03','But bi','hop','Thai Lan',100000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV01','Tap 100 giay mong','quyen','Trung Quoc',2500)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV02','Tap 200 giay mong','quyen','Trung Quoc',4500)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV03','Tap 100 giay tot','quyen','Viet Nam',3000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV04','Tap 200 giay tot','quyen','Viet Nam',5500)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV05','Tap 100 trang','chuc','Viet Nam',23000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV06','Tap 200 trang','chuc','Viet Nam',53000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('TV07','Tap 100 trang','chuc','Trung Quoc',34000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST01','So tay 500 trang','quyen','Trung Quoc',40000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST02','So tay loai 1','quyen','Viet Nam',55000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST03','So tay loai 2','quyen','Viet Nam',51000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST04','So tay','quyen','Thai Lan',55000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST05','So tay mong','quyen','Thai Lan',20000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST06','Phan viet bang','hop','Viet Nam',5000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST07','Phan khong bui','hop','Viet Nam',7000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST08','Bong bang','cai','Viet Nam',1000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST09','But long','cay','Viet Nam',5000)
    INSERT INTO SANPHAM(MASP,TENSP,DVT,NUOCSX,GIA) VALUES ('ST10','But long','cay','Trung Quoc',7000)

    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1001,'23/07/2006','KH01','NV01',320000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1002,'12/08/2006','KH01','NV02',840000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1003,'23/08/2006','KH02','NV01',100000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1004,'01/09/2006','KH02','NV01',180000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1005,'20/10/2006','KH01','NV02',3800000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1006,'16/10/2006','KH01','NV03',2430000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1007,'28/10/2006','KH03','NV03',510000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1008,'28/10/2006','KH01','NV03',440000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1009,'28/10/2006','KH03','NV04',200000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1010,'01/11/2006','KH01','NV01',5200000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1011,'04/11/2006','KH04','NV03',250000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1012,'30/11/2006','KH05','NV03',21000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1013,'12/12/2006','KH06','NV01',5000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1014,'31/12/2006','KH03','NV02',3150000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1015,'01/01/2007','KH06','NV01',910000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1016,'01/01/2007','KH07','NV02',12500)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1017,'02/01/2007','KH08','NV03',35000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1018,'13/01/2007','KH08','NV03',330000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1019,'13/01/2007','KH01','NV03',30000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1020,'14/01/2007','KH09','NV04',70000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1021,'16/01/2007','KH10','NV03',67500)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1022,'16/01/2007',NULL,'NV03',7000)
    INSERT INTO HOADON(SOHD,NGHD,MAKH,MANV,TRIGIA) VALUES (1023,'17/01/2007',NULL,'NV01',330000)

    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1001,'TV02',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1001,'ST01',5)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1001,'BC01',5)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1001,'BC02',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1001,'ST08',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1002,'BC04',20)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1002,'BB01',20)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1002,'BB02',20)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1003,'BB03',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1004,'TV01',20)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1004,'TV02',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1004,'TV03',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1004,'TV04',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1005,'TV05',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1005,'TV06',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1006,'TV07',20)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1006,'TV07',20)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1006,'ST01',30)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1006,'ST02',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1007,'ST03',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1008,'ST04',8)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1009,'ST05',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1010,'TV07',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1010,'ST07',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1010,'ST08',100)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1010,'ST04',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1010,'TV03',100)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1011,'ST06',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1012,'ST07',3)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1013,'ST08',5)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1014,'BC02',80)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1014,'BB02',100)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1014,'BC04',60)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1014,'BB01',50)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1015,'BB02',30)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1015,'BB03',7)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1016,'TV01',5)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1017,'TV02',1)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1017,'TV03',1)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1017,'TV04',5)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1018,'ST04',6)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1019,'ST05',1)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1019,'ST06',2)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1020,'ST07',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1021,'ST08',5)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1021,'TV01',7)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1021,'TV02',10)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1022,'ST07',1)
    INSERT INTO CTHD(SOHD,MASP,SL) VALUES (1023,'ST04',6)
    ALTER TABLE HOADON
    ALTER COLUMN MAKH CHAR(4) NULL
    --Cau 2: Tạo quan hệ SANPHAM1 chứa toàn bộ dữ liệu của quan hệ SANPHAM. 
    --Tạo quan hệ KHACHHANG1 chứa toàn bộ dữ liệu của quan hệ KHACHHANG.
    SELECT * INTO SANPHAM1 FROM SANPHAM
    SELECT * INTO KHACHHANG1 FROM KHACHHANG
    --Cau 3: Cập nhật giá tăng 5% đối với những sản phẩm do “Thai Lan” sản xuất (cho quan hệ SANPHAM1)
    UPDATE SANPHAM SET GIA = GIA + GIA * 5 / 100 
    WHERE NUOCSX = 'Thai Lan'
    --Cau 4: Cập nhật giá giảm 5% đối với những sản phẩm do “Trung Quoc” sản xuất có giá từ 10.000 trở xuống (cho quan hệ SANPHAM1).
    UPDATE SANPHAM SET GIA = GIA - GIA * 5 / 100 
    WHERE NUOCSX = 'Trung Quoc' AND GIA <= 10000

    SELECT GIA, NUOCSX FROM SANPHAM
    --Cau 5: 5.	Cập nhật giá trị LOAIKH là “Vip” đối với những khách hàng đăng ký thành viên 
    --trước ngày 1/1/2007 có doanh số từ 10.000.000 trở lên hoặc khách hàng đăng ký thành viên từ 1/1/2007 
    --trở về sau có doanh số từ 2.000.000 trở lên (cho quan hệ KHACHHANG1).
    UPDATE KHACHHANG1 SET LOAIKH = 'Vip'
    WHERE (NGDK < 1/1/2007 AND DOANHSO >= 10000000) OR (NGDK >= 1/1/2007 AND DOANHSO >= 2000000) 

    --Phan III: Ngôn ngữ truy vấn dữ liệu
    --Câu 1: In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” sản xuất.
    SELECT MASP, TENSP
    FROM SANPHAM
    WHERE NUOCSX = 'Trung Quoc'
    --2. In ra danh sách các sản phẩm (MASP, TENSP) có đơn vị tính là “cay”, ”quyen”. 
    SELECT MASP, TENSP
    FROM SANPHAM
    WHERE DVT = 'cay' OR DVT = 'quyen'
    --3. In ra danh sách các sản phẩm (MASP,TENSP) có mã sản phẩm bắt đầu là “B” và kết thúc là “01”. 
    SELECT MASP, TENSP
    FROM SANPHAM
    WHERE MASP LIKE 'B%01'
    --4. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quốc” sản xuất có giá từ 30.000 đến 
    --40.000. 
    SELECT MASP, TENSP
    FROM SANPHAM
    WHERE NUOCSX = 'Trung Quoc'
    AND GIA BETWEEN 30000 AND 40000
    --5. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” hoặc “Thai Lan” sản xuất có giá từ 
    --30.000 đến 40.000.
    SELECT * 
    FROM SANPHAM
    WHERE (NUOCSX = 'Trung Quoc' OR NUOCSX = 'Thai Lan') AND GIA BETWEEN 30000 AND 40000
    --6. In ra các số hóa đơn, trị giá hóa đơn bán ra trong ngày 1/1/2007 và ngày 2/1/2007. 
    SELECT SOHD, TRIGIA
    FROM HOADON
    WHERE NGHD BETWEEN '1/1/2007' AND '2/1/2007'
    --7. In ra các số hóa đơn, trị giá hóa đơn trong tháng 1/2007, sắp xếp theo ngày (tăng dần) và trị giá của 
    --hóa đơn (giảm dần).
    SELECT SOHD, TRIGIA
    FROM HOADON
    WHERE NGHD BETWEEN '1/1/2007' AND '31/1/2007'
    ORDER BY TRIGIA DESC
    --8. In ra danh sách các khách hàng (MAKH, HOTEN) đã mua hàng trong ngày 1/1/2007.
    SELECT KHACHHANG.MAKH, KHACHHANG.HOTEN
    FROM KHACHHANG
    JOIN HOADON ON KHACHHANG.MAKH = HOADON.MAKH
    WHERE NGHD = '1/1/2007'
    --9. In  ra  số  hóa  đơn,  trị  giá  các  hóa  đơn  do  nhân  viên  có  tên  “Nguyen  Van  B”  lập  trong  ngày 
    --28/10/2006.
    SELECT HOADON.SOHD, HOADON.TRIGIA
    FROM HOADON
    JOIN NHANVIEN on HOADON.MANV = NHANVIEN.MANV
    WHERE NHANVIEN.HOTEN = 'Nguyen Van B' 
    AND HOADON.NGHD = '28/10/2006'

    --10. In ra danh sách các sản phẩm (MASP,TENSP) được khách hàng có tên “Nguyen Van A” mua trong 
    --tháng 10/2006. 
    SELECT SANPHAM.MASP, SANPHAM.TENSP
    FROM CTHD
    JOIN HOADON ON CTHD.SOHD = HOADON.SOHD
    JOIN SANPHAM ON CTHD.MASP = SANPHAM.MASP
    JOIN KHACHHANG ON HOADON.MAKH = KHACHHANG.MAKH
    WHERE KHACHHANG.HOTEN = 'Nguyen Van A' AND MONTH(HOADON.NGHD) = 10 AND YEAR(HOADON.NGHD) = 2006

    --11. Tìm các số hóa đơn đã mua sản phẩm có mã số “BB01” hoặc “BB02”.
    SELECT DISTINCT CTHD.SOHD
    FROM CTHD
    JOIN HOADON ON CTHD.SOHD = HOADON.SOHD
    JOIN SANPHAM ON CTHD.MASP = SANPHAM.MASP
    WHERE SANPHAM.MASP IN ('BB01', 'BB02')

    --12. Tìm các số hóa đơn đã mua sản phẩm có mã số “BB01” hoặc “BB02”, mỗi sản phẩm mua với số 
    --lượng từ 10 đến 20.
    SELECT CTHD.SOHD
    FROM CTHD
    JOIN SANPHAM ON CTHD.MASP = SANPHAM.MASP
    WHERE SANPHAM.MASP IN ('BB01', 'BB02') AND CTHD.SL BETWEEN 10 AND 20

    --13. Tìm các số hóa đơn mua cùng lúc 2 sản phẩm có mã số “BB01” và “BB02”, mỗi sản phẩm mua với 
    --số lượng từ 10 đến 20.
    SELECT CTHD.SOHD
    FROM CTHD
    JOIN SANPHAM ON CTHD.MASP = SANPHAM.MASP
    WHERE SANPHAM.MASP = 'BB01' AND CTHD.SL BETWEEN 10 AND 20
    INTERSECT
    SELECT CTHD.SOHD
    FROM CTHD
    JOIN SANPHAM ON CTHD.MASP = SANPHAM.MASP
    WHERE SANPHAM.MASP = 'BB02' AND CTHD.SL BETWEEN 10 AND 20

    --14. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” sản xuất hoặc các sản phẩm được 
    --bán ra trong ngày 1/1/2007
    SELECT DISTINCT SP.MASP, SP.TENSP
    FROM SANPHAM SP
    LEFT JOIN CTHD C ON SP.MASP = C.MASP
    LEFT JOIN HOADON H ON H.SOHD = C.SOHD
    WHERE NUOCSX = 'Trung Quoc' or H.NGHD = '1/1/2007'

    -- 15. In ra danh sách các sản phẩm (MASP,TENSP) không bán được. 
    select SP.MASP, SP.TENSP
    from SANPHAM SP
    where SP.MASP not in (
        select distinct C.MASP
        from CTHD C
    )    

    -- 16. In ra danh sách các sản phẩm (MASP,TENSP) không bán được trong năm 2006
    SELECT SP.MASP, SP.TENSP
    FROM SANPHAM SP
    WHERE SP.MASP NOT IN 
    (
    select C.MASP
    from CTHD C
    JOIN HOADON H on H.SOHD = C.SOHD
    where YEAR(H.NGHD) = 2006
    )

    -- 17. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” sản xuất không bán được trong 
    -- năm 2006.
    SELECT SP.MASP, SP.TENSP
    FROM SANPHAM SP
    WHERE SP.NUOCSX = 'Trung Quoc' AND SP.MASP NOT IN 
    (
        SELECT C.MASP
        FROM CTHD C
        JOIN HOADON H ON C.SOHD = H.SOHD
        WHERE YEAR(H.NGHD) = 2006
    )

    -- 18. Tìm số hóa đơn đã mua tất cả các sản phẩm do Singapore sản xuất.
    SELECT H.SOHD
    FROM HOADON H
    JOIN CTHD C ON H.SOHD = C.SOHD
    JOIN SANPHAM SP ON C.MASP = SP.MASP
    WHERE SP.NUOCSX = 'Singapore'
    GROUP BY H.SOHD
    HAVING COUNT(DISTINCT C.MASP) = 
    (
        SELECT COUNT(DISTINCT SP.MASP)
        FROM SANPHAM SP
        WHERE NUOCSX = 'Singapore'
    )

    -- 19. Tìm số hóa đơn trong năm 2006 đã mua ít nhất tất cả các sản phẩm do Singapore sản xuất.
    SELECT H.SOHD
    FROM HOADON H
    JOIN CTHD C ON H.SOHD = C.SOHD
    JOIN SANPHAM S ON C.MASP = S.MASP
    WHERE YEAR(H.NGHD) = 2006 AND S.NUOCSX = 'Singapore'
    GROUP BY H.SOHD
    HAVING COUNT(DISTINCT S.MASP) = (
        SELECT COUNT(*)
        FROM SANPHAM 
        WHERE NUOCSX = 'Singapore'
    )

    -- 20. Có bao nhiêu hóa đơn không phải của khách hàng đăng ký thành viên mua? 
    SELECT COUNT(*)
    FROM HOADON
    WHERE MAKH IS NULL

    -- 21. Có bao nhiêu sản phẩm khác nhau được bán ra trong năm 2006.
    SELECT COUNT(DISTINCT S.MASP) AS SAN_PHAM_BAN_RA
    FROM SANPHAM S
    JOIN CTHD ON CTHD.MASP = S.MASP
    JOIN HOADON HD ON HD.SOHD = CTHD.SOHD
    WHERE YEAR(HD.NGHD) = 2006

    -- 22. Cho biết trị giá hóa đơn cao nhất, thấp nhất là bao nhiêu ?
    SELECT MAX(HD.TRIGIA) MAX_HD, MIN(HD.TRIGIA) MIN_HD
    FROM HOADON HD

    -- 23. Trị giá trung bình của tất cả các hóa đơn được bán ra trong năm 2006 là bao nhiêu?
    SELECT AVG(HD.TRIGIA) AS Average_value
    FROM HOADON HD
    WHERE YEAR(HD.NGHD) = 2006

    -- 24. Tính doanh thu bán hàng trong năm 2006. 
    SELECT SUM(HD.TRIGIA) AS Doanh_thu
    FROM HOADON HD
    WHERE YEAR(HD.NGHD) = 2006

    -- 25. Tìm số hóa đơn có trị giá cao nhất trong năm 2006.
    SELECT HD.SOHD AS MAX_BILL
    FROM HOADON HD
    WHERE YEAR(HD.NGHD) = 2006 AND HD.TRIGIA = (
        SELECT MAX(HD.TRIGIA) AS MAX_BILL
        FROM HOADON HD
    )

    -- 26. Tìm họ tên khách hàng đã mua hóa đơn có trị giá cao nhất trong năm 2006.
    SELECT DISTINCT KH.HOTEN HO_TEN
    FROM KHACHHANG KH
    JOIN HOADON HD ON KH.MAKH = HD.MAKH
    JOIN CTHD ON CTHD.SOHD = HD.SOHD
    WHERE YEAR(HD.NGHD) = 2006 AND HD.TRIGIA = (
        SELECT MAX(HD.TRIGIA)
        FROM HOADON HD 
        WHERE YEAR(HD.NGHD) = 2006
    )
    
    -- 27. In ra danh sách 3 khách hàng đầu tiên (MAKH, HOTEN) sắp xếp theo doanh số giảm dần.
    SELECT TOP 3 KH.MAKH, KH.HOTEN
    FROM KHACHHANG KH
    ORDER BY DOANHSO DESC

    -- 28. In ra danh sách các sản phẩm (MASP, TENSP) có giá bán bằng 1 trong 3 mức giá cao nhất. 
    SELECT TOP 3 SP.MASP, SP.TENSP
    FROM SANPHAM SP
    ORDER BY SP.GIA DESC
    
    -- 29. In ra danh sách các sản phẩm (MASP, TENSP) do “Thai Lan” sản xuất có giá bằng 1 trong 3 mức 
    -- giá cao nhất (của tất cả các sản phẩm).
    SELECT TOP 3 SP.MASP, SP.TENSP, SP.GIA
    FROM SANPHAM SP 
    WHERE SP.NUOCSX = 'Thai lan'
    ORDER BY SP.GIA DESC

    -- 30. In ra danh sách các sản phẩm (MASP, TENSP) do “Trung Quoc” sản xuất có giá bằng 1 trong 3 mức 
    -- giá cao nhất (của sản phẩm do “Trung Quoc” sản xuất)
    SELECT TOP 3 SP.MASP, SP.TENSP, SP.GIA
    FROM SANPHAM SP 
    WHERE SP.NUOCSX = 'Trung Quoc'
    ORDER BY SP.GIA DESC

    -- 31. * In ra danh sách khách hàng nằm trong 3 hạng cao nhất (xếp hạng theo doanh số).
    SELECT TOP 3 KH.MAKH
    FROM KHACHHANG KH 
    ORDER BY KH.DOANHSO DESC

    -- 32. Tính tổng số sản phẩm do “Trung Quoc” sản xuất.
    SELECT COUNT(*) AS TONG_SO_SP
    FROM SANPHAM SP
    WHERE SP.NUOCSX = 'Trung Quoc'

    -- 33. Tính tổng số sản phẩm của từng nước sản xuất.
    SELECT DISTINCT SP.NUOCSX, COUNT(*) AS Total_products
    FROM SANPHAM SP
    GROUP BY SP.NUOCSX
    
    -- 34. Với từng nước sản xuất, tìm giá bán cao nhất, thấp nhất, trung bình của các sản phẩm.
    SELECT SP.NUOCSX, MAX(SP.GIA) AS MaxValue, MIN(SP.GIA) AS MinValue, AVG(SP.GIA) AS AvgValue
    FROM SANPHAM SP
    GROUP BY SP.NUOCSX

    -- 35. Tính doanh thu bán hàng mỗi ngày.
    SELECT NGHD, SUM(HD.TRIGIA) AS DailyRevenue
    FROM HOADON HD
    GROUP BY NGHD

    -- 36. Tính tổng số lượng của từng sản phẩm bán ra trong tháng 10/2006.
    SELECT C.MASP, SUM(C.SL) AS TotalQuantity
    FROM CTHD C
    JOIN HOADON HD ON HD.SOHD = C.SOHD
    WHERE YEAR(HD.NGHD) = 2006 AND MONTH(HD.NGHD) = 10
    GROUP BY C.MASP

    -- 37. Tính doanh thu bán hàng của từng tháng trong năm 2006.
    SELECT MONTH(HD.NGHD) AS MONTH, SUM(HD.TRIGIA) AS MonthltRevenue
    FROM HOADON HD 
    WHERE YEAR(HD.NGHD) = 2006
    GROUP BY MONTH(NGHD)

    -- 38. Tìm hóa đơn có mua ít nhất 4 sản phẩm khác nhau.
    SELECT CTHD.SOHD
    FROM CTHD
    GROUP BY SOHD
    HAVING COUNT(DISTINCT CTHD.MASP) >= 4

    -- 39. Tìm hóa đơn có mua 3 sản phẩm do “Viet Nam” sản xuất (3 sản phẩm khác nhau).
    SELECT C.SOHD
    FROM CTHD C
    JOIN HOADON HD ON HD.SOHD = C.SOHD
    JOIN SANPHAM SP ON SP.MASP = C.MASP
    WHERE SP.NUOCSX = 'Viet Nam'
    GROUP BY C.SOHD
    HAVING COUNT(DISTINCT SP.MASP) = 3

----------------------------------------------------------------------------------------------


--BAI 2
CREATE DATABASE QLGV
USE QLGV

CREATE TABLE KHOA 
(
    MAKHOA VARCHAR(4),
    TENKHOA VARCHAR(40),
    NGTLAP SMALLDATETIME,
    TRGKHOA CHAR(4),
    PRIMARY KEY(MAKHOA) 
)

CREATE TABLE MONHOC
(
    MAMH VARCHAR(10),
    TENMH VARCHAR(40),
    TCLT TINYINT,
    TCTH TINYINT,
    MAKHOA VARCHAR(4),
    PRIMARY KEY(MAMH)
)

CREATE TABLE DIEUKIEN
(
    MAMH VARCHAR(10),
    MAMH_TRUOC VARCHAR(10)
)

CREATE TABLE GIAOVIEN
(
    MAGV CHAR(4),
    HOTEN VARCHAR(40),
    HOCVI VARCHAR(10),
    HOCHAM VARCHAR(10),
    GIOITINH VARCHAR(3),
    NGSINH SMALLDATETIME,
    NGVL SMALLDATETIME,
    HESO NUMERIC(4, 2),
    MUCLUONG MONEY,
    MAKHOA VARCHAR(4)
    PRIMARY KEY (MAGV)
)

CREATE TABLE LOP 
(
    MALOP CHAR(3),
    TENLOP VARCHAR(40),
    TRGLOP CHAR(5),
    SISO TINYINT,
    MAGVCN CHAR(4)
    PRIMARY KEY (MALOP)
)

CREATE TABLE HOCVIEN
(
    MAHV CHAR(5),
    HO VARCHAR(40),
    TEN VARCHAR(10),
    NGSINH SMALLDATETIME,
    GIOITINH VARCHAR(3),
    NOISINH VARCHAR(40),
    MALOP CHAR(3),
    PRIMARY KEY (MAHV)
)

CREATE TABLE GIANGDAY
(
    MALOP CHAR(3),
    MAMH VARCHAR(10),
    MAGV CHAR(4),
    HOCKY TINYINT,
    NAM SMALLINT,
    TUNGAY SMALLDATETIME,
    DENNGAY SMALLDATETIME,
)

CREATE TABLE KETQUATHI
(
    MAHV CHAR(5),
    MAMH VARCHAR(10),
    LANTHI TINYINT,
    NGTHI SMALLDATETIME,
    DIEM NUMERIC(4, 2),
    KQUA VARCHAR(10),
    PRIMARY KEY(MAHV, MAMH, LANTHI)
)

-- Khoa ngoai bang DIEUKIEN
ALTER TABLE DIEUKIEN ADD CONSTRAINT fk01_DIEUKIEN FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH)
ALTER TABLE DIEUKIEN ADD CONSTRAINT fk02_DIEUKIEN FOREIGN KEY(MAMH_TRUOC) REFERENCES MONHOC(MAMH)

-- Khoa ngoai bang GIANGDAY
ALTER TABLE GIANGDAY ADD CONSTRAINT fk01_GIANGDAY FOREIGN KEY(MALOP) REFERENCES LOP(MALOP)
ALTER TABLE GIANGDAY ADD CONSTRAINT fk02_GIANGDAY FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH)
ALTER TABLE GIANGDAY ADD CONSTRAINT fk03_GIANGDAY FOREIGN KEY(MAGV) REFERENCES GIAOVIEN(MAGV)

-- Khoa ngoai bang KETQUATHI
ALTER TABLE KETQUATHI ADD CONSTRAINT fk01_KETQUATHI FOREIGN KEY(MAHV) REFERENCES HOCVIEN(MAHV)
ALTER TABLE KETQUATHI ADD CONSTRAINT fk02_KETQUATHI FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH)
-- ALTER TABLE KETQUATHI ADD CONSTRAINT fk03_KETQUATHI FOREIGN KEY(LANTH) 

-- Khoa ngoai bang GIAOVIEN
ALTER TABLE GIAOVIEN ADD CONSTRAINT fk02_GIAOVIEN FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA)

-- Khoa ngoai bang LOP
ALTER TABLE LOP ADD CONSTRAINT fk01_LOP FOREIGN KEY(MAGVCN) REFERENCES GIAOVIEN(MAGV)

-- Khoa ngoai bang HOCVIEN
ALTER TABLE HOCVIEN ADD CONSTRAINT fk01_HOCVIEN FOREIGN KEY(MALOP) REFERENCES LOP(MALOP)

-- Khoa ngoai bang MONHOC
ALTER TABLE MONHOC ADD CONSTRAINT fk01_MONHOC FOREIGN KEY(MAKHOA) REFERENCES KHOA(MAKHOA)

-- Khoa ngoai bang KETQUATHI
ALTER TABLE KETQUATHI ADD CONSTRAINT fk01_KETQUATHI FOREIGN KEY(MAHV) REFERENCES HOCVIEN(MAHV)
ALTER TABLE KETQUATHI ADD CONSTRAINT fk02_KETQUATHI FOREIGN KEY(MAMH) REFERENCES MONHOC(MAMH)



--Delete table data
DELETE KHOA
DELETE MONHOC
DELETE LOP
DELETE GIAOVIEN
DELETE GIANGDAY
DELETE KETQUATHI
DELETE HOCVIEN
SET DATEFORMAT DMY

--Add table data
INSERT INTO KHOA(MAKHOA,TENKHOA,NGTLAP,TRGKHOA) VALUES ('KHMT','Khoa hoc may tinh','7/6/2005','GV01')
INSERT INTO KHOA(MAKHOA,TENKHOA,NGTLAP,TRGKHOA) VALUES ('HTTT','He thong thong tin','7/6/2005','GV02')
INSERT INTO KHOA(MAKHOA,TENKHOA,NGTLAP,TRGKHOA) VALUES ('CNPM','Cong nghe phan mem','7/6/2005','GV04')
INSERT INTO KHOA(MAKHOA,TENKHOA,NGTLAP,TRGKHOA) VALUES ('MTT','Mang va truyen thong','20/10/2005','GV03')
INSERT INTO KHOA(MAKHOA,TENKHOA,NGTLAP,TRGKHOA) VALUES ('KTMT','Ky thuat may tinh','20/12/2005',Null)

INSERT INTO LOP(MALOP,TENLOP,TRGLOP,SISO,MAGVCN) VALUES ('K11','Lop 1 khoa 1','K1108',11,'GV07')
INSERT INTO LOP(MALOP,TENLOP,TRGLOP,SISO,MAGVCN) VALUES ('K12','Lop 2 khoa 1','K1205',12,'GV09')
INSERT INTO LOP(MALOP,TENLOP,TRGLOP,SISO,MAGVCN) VALUES ('K13','Lop 3 khoa 1','K1305',12,'GV14')

INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV01','Ho Thanh Son','PTS','GS','Nam','2/5/1950','11/1/2004','5',2250000,'KHMT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV02','Tran Tam Thanh','TS','PGS','Nam','17/12/1965','20/4/2004','4.5',2025000,'HTTT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV03','Do Nghiem Phung','TS','GS','Nu','1/8/1950','23/9/2004','4',1800000,'CNPM')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV04','Tran Nam Son','TS','PGS','Nam','22/2/1961','12/1/2005','4.5',2025000,'KTMT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV05','Mai Thanh Danh','ThS','GV','Nam','12/3/1958','12/1/2005','3',1350000,'HTTT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV06','Tran Doan Hung','TS','GV','Nam','11/3/1953','12/1/2005','4.5',2025000,'KHMT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV07','Nguyen Minh Tien','ThS','GV','Nam','23/11/1971','1/3/2005','4',1800000,'KHMT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV08','Le Thi Tran','KS','Null','Nu','26/3/1974','1/3/2005','1.69',760500,'KHMT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV09','Nguyen To Lan','ThS','GV','Nu','31/12/1966','1/3/2005','4',1800000,'HTTT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV10','Le Tran Anh Loan','KS','Null','Nu','17/7/1972','1/3/2005','1.86',837000,'CNPM')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV11','Ho Thanh Tung','CN','GV','Nam','12/1/1980','15/5/2005','2.67',1201500,'MTT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV12','Tran Van Anh','CN','Null','Nu','29/3/1981','15/5/2005','1.69',760500,'CNPM')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV13','Nguyen Linh Dan','CN','Null','Nu','23/5/1980','15/5/2005','1.69',760500,'KTMT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV14','Truong Minh Chau','ThS','GV','Nu','30/11/1976','15/5/2005','3',1350000,'MTT')
INSERT INTO GIAOVIEN(MAGV,HOTEN,HOCVI,HOCHAM,GIOITINH,NGSINH,NGVL,HESO,MUCLUONG,MAKHOA) VALUES ('GV15','Le Ha Thanh','ThS','GV','Nam','4/5/1978','15/5/2005','3',1350000,'KHMT')

INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('THDC','Tin hoc dai cuong',4,1,'KHMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('CTRR','Cau truc roi rac',5,0,'KHMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('CSDL','Co so du lieu',3,1,'HTTT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('CTDLGT','Cau truc du lieu va giai thuat',3,1,'KHMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('PTTKTT','Phan tich thiet ke thuat toan',3,0,'KHMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('DHMT','Do hoa may tinh',3,1,'KHMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('KTMT','Kien truc may tinh',3,0,'KTMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('TKCSDL','Thiet ke co so du lieu',3,1,'HTTT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('PTTKHTTT','Phan tich thiet ke he thong thong tin',4,1,'HTTT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('HDH','He dieu hanh',4,0,'KTMT')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('NMCNPM','Nhap mon cong nghe phan mem',3,0,'CNPM')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('LTCFW','Lap trinh C for win',3,1,'CNPM')
INSERT INTO MONHOC(MAMH,TENMH,TCLT,TCTH,MAKHOA) VALUES ('LTHDT','Lap trinh huong doi tuong',3,1,'CNPM')

INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K11','THDC','GV07',1,'2006','2/1/2006','12/5/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K12','THDC','GV06',1,'2006','2/1/2006','12/5/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K13','THDC','GV15',1,'2006','2/1/2006','12/5/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K11','CTRR','GV02',1,'2006','9/1/2006','17/5/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K12','CTRR','GV02',1,'2006','9/1/2006','17/5/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K13','CTRR','GV08',1,'2006','9/1/2006','17/5/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K11','CSDL','GV05',2,'2006','1/6/2006','15/7/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K12','CSDL','GV09',2,'2006','1/6/2006','15/7/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K13','CTDLGT','GV15',2,'2006','1/6/2006','15/7/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K13','CSDL','GV05',3,'2006','1/8/2006','15/12/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K13','DHMT','GV07',3,'2006','1/8/2006','15/12/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K11','CTDLGT','GV15',3,'2006','1/8/2006','15/12/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K12','CTDLGT','GV15',3,'2006','1/8/2006','15/12/2006')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K11','HDH','GV04',1,'2007','2/1/2007','18/2/2007')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K12','HDH','GV04',1,'2007','2/1/2007','20/3/2007')
INSERT INTO GIANGDAY(MALOP,MAMH,MAGV,HOCKY,NAM,TUNGAY,DENNGAY) VALUES ('K11','DHMT','GV07',1,'2007','18/2/2007','20/3/2007')

INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1101','CSDL',1,'20/7/2006',10,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1101','CTDLGT',1,'28/12/2006',9,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1101','THDC',1,'20/5/2006',9,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1101','CTRR',1,'13/5/2006',9.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CSDL',1,'20/7/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CSDL',2,'27/7/2006',4.25,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CSDL',3,'10/8/2006',4.5,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CTDLGT',1,'28/12/2006',4.5,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CTDLGT',2,'5/1/2007',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CTDLGT',3,'15/1/2007',6,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','THDC',1,'20/5/2006',5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1102','CTRR',1,'13/5/2006',7,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1103','CSDL',1,'20/7/2006',3.5,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1103','CSDL',2,'27/7/2006',8.25,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1103','CTDLGT',1,'28/12/2006',7,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1103','THDC',1,'20/5/2006',8,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1103','CTRR',1,'13/5/2006',6.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1104','CSDL',1,'20/7/2006',3.75,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1104','CTDLGT',1,'28/12/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1104','THDC',1,'20/5/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1104','CTRR',1,'13/5/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1104','CTRR',2,'20/5/2006',3.5,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1104','CTRR',3,'30/6/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1201','CSDL',1,'20/7/2006',6,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1201','CTDLGT',1,'28/12/2006',5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1201','THDC',1,'20/5/2006',8.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1201','CTRR',1,'13/5/2006',9,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','CSDL',1,'20/7/2006',8,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','CTDLGT',1,'28/12/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','CTDLGT',2,'5/1/2007',5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','THDC',1,'20/5/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','THDC',2,'27/5/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','CTRR',1,'13/5/2006',3,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','CTRR',2,'20/5/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1202','CTRR',3,'30/6/2006',6.25,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1203','CSDL',1,'20/7/2006',9.25,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1203','CTDLGT',1,'28/12/2006',9.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1203','THDC',1,'20/5/2006',10,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1203','CTRR',1,'13/5/2006',10,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1204','CSDL',1,'20/7/2006',8.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1204','CTDLGT',1,'28/12/2006',6.75,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1204','THDC',1,'20/5/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1204','CTRR',1,'13/5/2006',6,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1301','CSDL',1,'20/12/2006',4.25,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1301','CTDLGT',1,'25/7/2006',8,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1301','THDC',1,'20/5/2006',7.75,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1301','CTRR',1,'13/5/2006',8,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1302','CSDL',1,'20/12/2006',6.75,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1302','CTDLGT',1,'25/7/2006',5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1302','THDC',1,'20/5/2006',8,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1302','CTRR',1,'13/5/2006',8.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','CSDL',1,'20/12/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','CTDLGT',1,'25/7/2006',4.5,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','CTDLGT',2,'7/8/2006',4,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','CTDLGT',3,'15/8/2006',4.25,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','THDC',1,'20/5/2006',4.5,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','CTRR',1,'13/5/2006',3.25,'Khong Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1303','CTRR',2,'20/5/2006',5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1304','CSDL',1,'20/12/2006',7.75,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1304','CTDLGT',1,'25/7/2006',9.75,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1304','THDC',1,'20/5/2006',5.5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1304','CTRR',1,'13/5/2006',5,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1305','CSDL',1,'20/12/2006',9.25,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1305','CTDLGT',1,'25/7/2006',10,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1305','THDC',1,'20/5/2006',8,'Dat')
INSERT INTO KETQUATHI(MAHV,MAMH,LANTHI,NGTHI,DIEM,KQUA) VALUES ('K1305','CTRR',1,'13/5/2006',10,'Dat')

INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1101','Nguyen Van','A','27/1/1986','Nam','TpHCM','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1102','Tran Ngoc','Han','14/3/1986','Nu','Kien Giang','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1103','Ha Duy','Lap','18/4/1986','Nam','Nghe An','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1104','Tran Ngoc','Linh','30/3/1986','Nu','Tay Ninh','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1105','Tran Minh','Long','27/2/1986','Nam','TpHCM','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1106','Le Nhat','Minh','24/1/1986','Nam','TpHCM','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1107','Nguyen Nhu','Nhut','27/1/1986','Nam','Ha Noi','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1108','Nguyen Manh','Tam','27/2/1986','Nam','Kien Giang','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1109','Phan Thi Thanh','Tam','27/1/1986','Nu','Vinh Long','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1110','Le Hoai','Thuong','5/2/1986','Nu','Can Tho','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1111','Le Ha','Vinh','25/12/1986','Nam','Vinh Long','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1201','Nguyen Van','B','11/2/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1202','Nguyen Thi Kim','Duyen','18/1/1986','Nu','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1203','Tran Thi Kim','Duyen','17/9/1986','Nu','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1204','Truong My','Hanh','19/5/1986','Nu','Dong Nai','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1205','Nguyen Thanh','Nam','17/4/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1206','Nguyen Thi Truc','Thanh','4/3/1986','Nu','Kien Giang','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1207','Tran Thi Bich','Thuy','8/2/1986','Nu','Nghe An','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1208','Huynh Thi Kim','Trieu','8/4/1986','Nu','Tay Ninh','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1209','Pham Thanh','Trieu','23/2/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1210','Ngo Thanh','Tuan','14/2/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1211','Do Thi','Xuan','9/3/1986','Nu','Ha Noi','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1212','Le Thi Phi','Yen','12/3/1986','Nu','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1301','Nguyen Thi Kim','Cuc','9/6/1986','Nu','Kien Giang','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1302','Truong Thi My','Hien','18/3/1986','Nu','Nghe An','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1303','Le Duc','Hien','21/3/1986','Nam','Tay Ninh','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1304','Le Quang','Hien','18/4/1986','Nam','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1305','Le Thi','Huong','27/3/1986','Nu','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1306','Nguyen Thai','Huu','30/3/1986','Nam','Ha Noi','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1307','Tran Minh','Man','28/5/1986','Nam','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1308','Nguyen Hieu','Nghia','8/4/1986','Nam','Kien Giang','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1309','Nguyen Trung','Nghia','18/1/1987','Nam','Nghe An','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1310','Tran Thi Hong','Tham','22/4/1986','Nu','Tay Ninh','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1311','Tran Minh','Thuc','4/4/1986','Nam','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1312','Nguyen Thi Kim','Yen','7/9/1986','Nu','TpHCM','K13')

-- I. Ngôn ngữ định nghĩa dữ liệu (Data Definition Language):
--Cau 1
ALTER TABLE HOCVIEN ADD GHICHU VARCHAR(40)
ALTER TABLE HOCVIEN ADD DIEMTB NUMERIC(4, 2)
ALTER TABLE HOCVIEN ADD XEPLOAI VARCHAR(10)

--Cau 3
ALTER TABLE HOCVIEN ADD CONSTRAINT CK_GIOITINH CHECK (GIOITINH IN ('Nam', 'Nu'))

--Cau 4 
ALTER TABLE KETQUATHI 
ADD CONSTRAINT CK_DIEM CHECK (DIEM >= 0 AND DIEM <= 10)

--Cau 5
UPDATE KETQUATHI
SET KQUA = CASE 
    WHEN DIEM >= 5 THEN 'DAT'
    ELSE 'KHONG DAT'
END

--Cau 6 
ALTER TABLE KETQUATHI
ADD CONSTRAINT CK_LANTHI CHECK (LANTHI <= 3)

--Cau 7
ALTER TABLE GIANGDAY
ADD CONSTRAINT CK_HOCKY CHECK (HOCKY BETWEEN 1 AND 3)

--Cau 8
ALTER TABLE GIAOVIEN 
ADD CONSTRAINT CK_HOCVI CHECK (HOCVI IN ('CN', 'KS', 'Ths', 'TS', 'PTS'))

--Cau 11: Học viên ít nhất là 18 tuổi.
ALTER TABLE HOCVIEN
ADD CONSTRAINT CK_NGSINH CHECK (DATEDIFF(YEAR, NGSINH, GETDATE()) >= 18)

--Cau 12: Giảng dạy một môn học ngày bắt đầu (TUNGAY) phải nhỏ hơn ngày kết thúc (DENNGAY).
ALTER TABLE GIANGDAY
ADD CONSTRAINT CK_NGAY CHECK (TUNGAY < DENNGAY)

--Cau 13: Giáo viên khi vào làm ít nhất là 22 tuổi.
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CK_NGSINH CHECK (DATEDIFF(YEAR, NGSINH, GETDATE()) >= 22 )

--Cau 14: Tất cả các môn học đều có số tín chỉ lý thuyết và tín chỉ thực hành chênh lệch nhau không quá 3.
ALTER TABLE MONHOC
ADD CONSTRAINT CK_TINCHI CHECK (ABS(TCLT - TCTH) <= 3)

-- II. Ngôn ngữ thao tác dữ liệu (Data Manipulation Language):
-- 1. Tăng hệ số lương thêm 0.2 cho những giáo viên là trưởng khoa. 
UPDATE GIAOVIEN
SET HESO = HESO * 1.2
WHERE GIAOVIEN.MAGV IN 
(
    SELECT KHOA.TRGKHOA
    FROM KHOA 
    WHERE KHOA.TRGKHOA IS NOT NULL
)
-- 2. Cập nhật giá trị điểm trung bình tất cả các môn học (DIEMTB) của mỗi học viên (tất cả các môn 
-- học đều có hệ số 1 và nếu học viên thi một môn nhiều lần, chỉ lấy điểm của lần thi sau cùng). 
UPDATE HOCVIEN 
SET DIEMTB = (
    SELECT AVG(KQ.DIEM)
    FROM (
        -- Lấy điểm của lần thi cuối cùng cho 4 môn học
        SELECT MAMH, DIEM
        FROM KETQUATHI KQ2
        WHERE KQ2.MAHV = HOCVIEN.MAHV
        AND KQ2.MAMH IN ('THDC', 'CTRR', 'CSDL', 'CTDLGT')
        AND KQ2.LANTHI = (
            SELECT MAX(LANTHI)
            FROM KETQUATHI KQ3
            WHERE KQ3.MAHV = KQ2.MAHV 
            AND KQ3.MAMH = KQ2.MAMH
        )
    ) KQ
)

-- 3. Cập nhật giá trị cho cột GHICHU là “Cam thi” đối với trường hợp: học viên có một môn bất kỳ thi 
-- lần thứ 3 dưới 5 điểm. 
UPDATE HOCVIEN
SET GHICHU = 'Cam thi'
WHERE MAHV IN (
    SELECT DISTINCT MAHV
    FROM KETQUATHI
    WHERE LANTHI = 3 AND DIEM < 5
)

-- 4. Cập nhật giá trị cho cột XEPLOAI trong quan hệ HOCVIEN như sau: 
UPDATE HOCVIEN
SET XEPLOAI = CASE
    WHEN DIEMTB >= 9 THEN 'XS'
    WHEN DIEMTB >= 8 AND DIEMTB < 9 THEN 'Gioi'
    WHEN DIEMTB >= 6.5 AND DIEMTB < 8 THEN 'K'
    WHEN DIEMTB >= 5 AND DIEMTB < 6.5 THEN 'TB'
    ELSE 'Y' 
END

SELECT * FROM HOCVIEN

--III. Ngôn ngữ truy vấn dữ liệu:
--1. In ra danh sách (mã học viên, họ tên, ngày sinh, mã lớp) lớp trưởng của các lớp.
SELECT HOCVIEN.MAHV, HOCVIEN.HO, HOCVIEN.TEN, HOCVIEN.NGSINH, LOP.MALOP
FROM HOCVIEN
JOIN LOP ON HOCVIEN.MAHV = LOP.TRGLOP
--2. In ra bảng điểm khi thi (mã học viên, họ tên, lần thi, điểm số) môn CTRR của lớp “K12”, sắp xếp theo tên, họ học viên
SELECT HOCVIEN.MAHV, HOCVIEN.HO, HOCVIEN.TEN, KETQUATHI.LANTHI, KETQUATHI.DIEM
FROM HOCVIEN
JOIN KETQUATHI ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE KETQUATHI.MAMH = 'CTRR' AND HOCVIEN.MALOP = 'K12'
ORDER BY HOCVIEN.TEN, HOCVIEN.HO;
--3. In ra danh sách những học viên (mã học viên, họ tên) và những môn học mà học viên đó thi lần thứ nhất đã đạt
SELECT DISTINCT HOCVIEN.MAHV, HOCVIEN.HO, HOCVIEN.TEN, KETQUATHI.MAMH
FROM HOCVIEN
JOIN KETQUATHI ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE KETQUATHI.LANTHI = 1 AND KETQUATHI.KQUA = 'Dat';
--4. In ra danh sách học viên (mã học viên, họ tên) của lớp “K11” thi môn CTRR không đạt (ở lần thi 1)
SELECT HOCVIEN.MAHV, HOCVIEN.HO, HOCVIEN.TEN
FROM HOCVIEN
JOIN KETQUATHI ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE HOCVIEN.MALOP = 'K11' AND KETQUATHI.MAMH = 'CTRR' AND KETQUATHI.LANTHI = 1 AND KETQUATHI.KQUA = 'Khong Dat';
--5. Danh sách học viên (mã học viên, họ tên) của lớp “K” thi môn CTRR không đạt (ở tất cả các lần thi)
SELECT HOCVIEN.MAHV, HOCVIEN.HO, HOCVIEN.TEN
FROM HOCVIEN
JOIN KETQUATHI ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE HOCVIEN.MALOP LIKE 'K%' AND KETQUATHI.MAMH = 'CTRR'
GROUP BY HOCVIEN.MAHV, HOCVIEN.HO, HOCVIEN.TEN
HAVING SUM(CASE WHEN KETQUATHI.KQUA = 'Khong Dat' THEN 1 ELSE 0 END) = COUNT(KETQUATHI.LANTHI);
-- 6. Tìm tên những môn học mà giáo viên có tên “Tran Tam Thanh” dạy trong học kỳ 1 năm 2006. 
SELECT DISTINCT TENMH
FROM MONHOC MH
JOIN GIANGDAY GD ON MH.MAMH = GD.MAMH
JOIN GIAOVIEN GV ON GV.MAGV = GD.MAGV
WHERE GV.HOTEN = 'Tran Tam Thanh' AND GD.HOCKY = 1 AND NAM = 2006
-- 7. Tìm những môn học (mã môn học, tên môn học) mà giáo viên chủ nhiệm lớp “K11” dạy trong học 
-- kỳ 1 năm 2006. 
SELECT MH.MAMH, MH.TENMH
FROM MONHOC MH
JOIN GIANGDAY GD ON GD.MAMH = MH.MAMH
JOIN LOP ON LOP.MALOP = GD.MALOP
JOIN GIAOVIEN GV ON GD.MAGV = GV.MAGV
WHERE LOP.MALOP = 'K11'
  AND GD.HOCKY = 1
  AND GD.NAM = 2006;

-- 8. Tìm họ tên lớp trưởng của các lớp mà giáo viên có tên “Nguyen To Lan” dạy môn “Co So Du Lieu”. 
SELECT DISTINCT HV.HO + ' ' + HV.TEN AS 'HO VA TEN'
FROM HOCVIEN HV
JOIN LOP ON HV.MAHV = LOP.TRGLOP
JOIN GIANGDAY GD ON LOP.MALOP = GD.MALOP
JOIN MONHOC MH ON GD.MAMH = MH.MAMH
JOIN GIAOVIEN GV ON GD.MAGV = GV.MAGV
WHERE GV.HOTEN = 'Nguyen To Lan'
  AND MH.TENMH = 'Co So Du Lieu';
-- 9. In ra danh sách những môn học (mã môn học, tên môn học) phải học liền trước môn “Co So Du 
-- Lieu”. 
SELECT MH.MAMH, MH.TENMH
FROM MONHOC MH
JOIN DIEUKIEN DK ON MH.MAMH = DK.MAMH_TRUOC
WHERE DK.MAMH = (
    SELECT MAMH
    FROM MONHOC
    WHERE TENMH = 'Co So Du Lieu'
);
-- 10. Môn “Cau Truc Roi Rac” là môn bắt buộc phải học liền trước những môn học (mã môn học, tên 
-- môn học) nào. 
SELECT MH.MAMH, MH.TENMH
FROM MONHOC MH
JOIN DIEUKIEN DK ON MH.MAMH = DK.MAMH_TRUOC
WHERE DK.MAMH = (
    SELECT MAMH
    FROM MONHOC MH
    WHERE TENMH = 'Cau truc roi rac'
)

-- 11. Tìm họ tên giáo viên dạy môn CTRR cho cả hai lớp “K11” và “K12” trong cùng học kỳ 1 năm 2006.
SELECT GV.HOTEN
FROM GIAOVIEN GV
JOIN GIANGDAY GD1 ON GD1.MAGV = GV.MAGV
WHERE GD1.MAMH = 'CTRR'
AND GD1.HOCKY = 1
AND GD1.NAM = 2006
AND GD1.MALOP = 'K11'
AND EXISTS(
    SELECT 1
    FROM GIANGDAY GD2
    WHERE GD2.MAMH = 'CTRR'
    AND GD2.NAM = 2006
    AND GD2.HOCKY = 1
    AND GD2.MALOP = 'K12'
    AND GD2.MAGV = GV.MAGV
)

-- 12. Tìm những học viên (mã học viên, họ tên) thi không đạt môn CSDL ở lần thi thứ 1 nhưng chưa thi 
-- lại môn này. 
SELECT HV.MAHV, HV.HO + ' ' + HV.TEN
FROM HOCVIEN HV
JOIN KETQUATHI KQ ON HV.MAHV = KQ.MAHV
WHERE KQ.MAMH = 'CSDL'
    AND KQ.LANTHI = 1
    AND KQ.KQUA = 'Khong Dat'
    AND NOT EXISTS (
        SELECT 1
        FROM KETQUATHI KQ2 
        WHERE KQ2.MAHV = KQ.MAHV
        AND KQ2.MAMH = 'CSDL'
        AND KQ2.LANTHI > 1
    )
-- 13. Tìm giáo viên (mã giáo viên, họ tên) không được phân công giảng dạy bất kỳ môn học nào. 
SELECT G.MAGV, G.HOTEN
FROM GIAOVIEN G
LEFT JOIN GIANGDAY GD ON G.MAGV = GD.MAGV
WHERE GD.MAGV IS NULL;

-- 14. Tìm giáo viên (mã giáo viên, họ tên) không được phân công giảng dạy bất kỳ môn học nào thuộc 
-- khoa giáo viên đó phụ trách. 
SELECT G.MAGV, G.HOTEN
FROM GIAOVIEN G
WHERE NOT EXISTS (
    SELECT 1 
    FROM GIANGDAY GD 
    JOIN MONHOC MH ON GD.MAMH = MH.MAMH 
    WHERE GD.MAGV = G.MAGV 
      AND MH.MAKHOA = G.MAKHOA
  );

-- 15. Tìm họ tên các học viên thuộc lớp “K11” thi một môn bất kỳ quá 3 lần vẫn “Khong dat” hoặc thi lần 
-- thứ 2 môn CTRR được 5 điểm. 
SELECT HV.HO || ' ' || HV.TEN AS HOTEN
FROM HOCVIEN HV
JOIN KETQUATHI KQ ON HV.MAHV = KQ.MAHV
WHERE HV.MALOP = 'K11' 
  AND ((KQ.LANTHI > 3 AND KQ.KQUA = 'Khong Dat') 
  OR (KQ.MAMH = 'CTRR' AND KQ.LANTHI = 2 AND KQ.DIEM = 5));

-- 16. Tìm họ tên giáo viên dạy môn CTRR cho ít nhất hai lớp trong cùng một học kỳ của một năm học. 
SELECT G.HOTEN
FROM GIANGDAY GD
JOIN GIAOVIEN G ON GD.MAGV = G.MAGV
WHERE GD.MAMH = 'CTRR'
GROUP BY G.HOTEN, GD.HOCKY, GD.NAM
HAVING COUNT(DISTINCT GD.MALOP) >= 2;

-- 17. Danh sách học viên và điểm thi môn CSDL (chỉ lấy điểm của lần thi sau cùng). 
SELECT HV.MAHV, HV.HO || ' ' || HV.TEN AS HOTEN, KQ.DIEM
FROM HOCVIEN HV
JOIN KETQUATHI KQ ON HV.MAHV = KQ.MAHV
WHERE KQ.MAMH = 'CSDL' 
  AND KQ.LANTHI = (
    SELECT MAX(KQ2.LANTHI) 
    FROM KETQUATHI KQ2 
    WHERE KQ2.MAHV = KQ.MAHV AND KQ2.MAMH = 'CSDL'
  );

-- 18. Danh sách học viên và điểm thi môn “Co So Du Lieu” (chỉ lấy điểm cao nhất của các lần thi). 
SELECT HV.MAHV, HV.HO || ' ' || HV.TEN AS HOTEN, MAX(KQ.DIEM) AS MAX_DIEM
FROM HOCVIEN HV
JOIN KETQUATHI KQ ON HV.MAHV = KQ.MAHV
WHERE KQ.MAMH = 'CSDL'
GROUP BY HV.MAHV, HV.HO, HV.TEN;
